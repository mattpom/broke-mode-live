
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lounge Chat â€“ Broke Mode</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #fff; color: #111; }
    #chatbox { height: 300px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 8px; margin-bottom: 12px; }
    #messageInput { width: 70%; padding: 10px; border-radius: 6px; border: 1px solid #ccc; }
    #sendButton { padding: 10px 20px; background: #111; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>ðŸ’¬ Live Chat â€“ Broke Mode Lounge</h2>
  <div id="chatbox"></div>
  <input id="messageInput" placeholder="Type your message..." />
  <button id="sendButton">Send</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
    import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDV19CX2yaPRGgGpyezN0QywFo2m9wj76M",
      authDomain: "brokemode-lounge.firebaseapp.com",
      databaseURL: "https://brokemode-lounge-default-rtdb.firebaseio.com",
      projectId: "brokemode-lounge",
      storageBucket: "brokemode-lounge.firebasestorage.app",
      messagingSenderId: "810076817793",
      appId: "1:810076817793:web:5a4f9005a80b9228274080",
      measurementId: "G-8FEV5WDBDJ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth();

    signInAnonymously(auth)
      .then(() => console.log("âœ… Signed in anonymously"))
      .catch((err) => console.error("âŒ Auth failed:", err));

    const chatbox = document.getElementById("chatbox");
    const input = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendButton");
    const messagesRef = ref(db, "messages");

    sendBtn.addEventListener("click", () => {
      const text = input.value.trim();
      if (text) {
        push(messagesRef, { username: "Guest", text });
        input.value = "";
      }
    });

    onChildAdded(messagesRef, (snapshot) => {
      const msg = snapshot.val();
      const p = document.createElement("p");
      p.textContent = `${msg.username || "Anon"}: ${msg.text || ""}`;
      chatbox.appendChild(p);
      chatbox.scrollTop = chatbox.scrollHeight;
      console.log("ðŸ’¬ Message received:", msg);
    });
  </script>
</body>
</html>
